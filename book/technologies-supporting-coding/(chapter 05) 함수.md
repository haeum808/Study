## 함수의 역할

함수, 즉 '코드의 일부를 한 덩어리로 잘라내어 그것에 이름을 붙이는 기능'

### 이해(조직을 예로)

사람 수가 늘었을 때는 모든 것을 파악하기 어려워진다. 그래서 몇 명을 하나의 그룹으로 묶어서 이름을 붙이게 된다.  
프로그래밍도 동일하다. 소스 코드의 행수가 많아지면 전체를 파악하기 어렵게 된다.

### 재사용(부품을 예로)

아무것도 없는 상태에서 무선 조정 자동차를 만들려고 하면, 모터나 전지도 자체적으로 만들어야 한다.  
함수도 동일하다. 수십 행, 수백 행의 코드가 함수로 정리되어 제공되고 있어서 쉽게 그 함수를 호출해서 사용할 수 있다.

### 프로그램 재사용의 특징

프로그램을 만드는 것과 물리적인 것을 만드는 것에는 부품을 재사용하고 싶을 때 드는 비용에 차이가 있다.

같은 처리를 한 군데에 정리하여 생기는 이점은 단순히 프로그램이 짧아지는 데에만 있지 않고 소스 코드를 읽는 사람이 몇 번이고 같은 내용의 소스 코드를 읽을 필요도 없어진다.

## 돌아가는 명령

goto 문으로 못하는 것, 그것은 바로 '원래 위치로 돌아가'는 것이다.  
'원래 위치로 돌아가'는 명령이 가능하면 코드를 재사용할 수 있게 된다.

### 함수의 탄생

함수를 호출한 후 원래 위치로 돌아오는 것을 점프 명령의 목적지를 변경해서 구현했었다.  

1: 110의 점프 명령의 점프 목적지를 3으로 바꾼다  
2: 함수를 호출한다 (100으로 점프)  
3: 다음 명령  
......  
51: 110의 점프 명령의 점프 목적지를 53으로 바꾼다  
52: 함수 호출 (100으로 점프)  
53: 다음 명령  
......  
100: 함수 처리  
......  
110: 돌아간다 (0으로 점프)  

### 돌아갈 목적지를 기록하기 위한 전용 메모리

이후에 조금 더 개선된 방법이 발명되었다.  
돌아갈 목적지를 기록해두는 전용 메모리를 만들어 '돌아갈 목적지 메모리(보통 레지스터)에 적어둔 번지로 점프하는 명령'을 준비해두는 방법이다.  

1: '돌아갈 목적지 메모리'에 3을 넣는다  
2: 함수 호출 (100으로 점프)  
3: 다음 명령  
......  
100: 함수 처리  
......  
110: 돌아갈 목적지 메모리에 써있는 지번으로 돌아간다  

그러나 이 방법에는 문제가 있다.  
함수 X를 호출하고 있는 중에 다른 함수 Y를 호출하면, 돌아갈 목적지 메모리에 덮어 씌워져서 함수 X가 돌아갈 목적지를 잊어버리게 된다.

### 스택

스택은 복수의 값을 저장해두는 데이터 구조로, 마지막에 넣은 것을 가장 먼저 꺼내는 경우에 적합하다.  

'스택의 머리가 어딘지'를 기록해두는 메모리 위치를 정한다. 새로운 데이터를 기록할 때는 번지의 값을 1 증가시킨 후, 거기에 적혀있는 번지에 데이터를 기록한다.  

함수 X를 호출하고 있는 중에 함수 Y가 호출되어도, 함수 X가 돌아갈 목적지가 살아있어서 제대로 돌아갈 수 있다.

## 재귀 호출

재귀 호출이란 함수 X 안에서 함수 X 자신을 호출하는 것이다.

### 내포 구조 데이터의 호율적 처리

재귀 호출을 사용하고 있는 프로그램을 재귀 호출 없이도 만들 수 있다.  

'어떤 처리를 하고 있는 도중에 동일한 처리를 다른 대상에 대해 실행한다'는 내포 형태의 처리다.  
내포된 데이터 구조를 다룰 때는 코드도 함유 구조가 되는 경우가 많다.

### 내포 구조를 다루는 방법

[1, 2, [3, 4], 5]라는 리스트를 생각해보자. 이것은 [1, 2, ?, 5]라는 리스트의 ? 부분에 [3, 4]라는 별도의 리스트가 내포되어 있다.  
이 내포 리스트에 있는 숫자를 전부 합산하고 싶을 때는 어떻게 하면 될까?  

```Python
def total(xs):
    result = 0
    for x in xs:
        # 리스트 xs 에서 요소를 하나씩 꺼내 x 라고 한다.
        if is_integer(x):
            # x가 정수이면 더한다
            result += x
        else:
            # x가 정수가 아니면 무엇을 할까 ?
    
    return result
```

#### for로 구현할 수 없다

3중 내포의 리스트가 입력되면 두 번 째 for 문을 처리하고 있을 때 다시 리스트가 출현한다.

```Python
def total(xs):
    result = 0
    for x in xs:
        if is_integer(x):
            result += x
        else:
            # x가 리스트이기 때문에 for문으로 돌린다
            for y in x:
                if is_integer(y):
                    result += y
                else:
                    # 추가로 리스트가 나오면 어떻게 하면 좋지?
    
    return result
```

#### 재귀 호출을 사용

그래서 존재하는 것이 재귀 호출이다.

```Python
def total(xs):
    result = 0
    for x in xs:
        if is_integer(x):
            result += x
        else:
            # x는 내포 리스트이기 때문에 total로 안에 든 값을 합산한다!
            result += total(x)
        
    return result
```

#### 재귀 호출의 처리 흐름

함수 호출마다 개별적으로 xs나 result 등의 값을 기억하는 장소가 있다는 것과  
두 번째 total 처리가 완료됐을 때 첫 번째 total 처리는 아직 계속 진행되고 있는 것 등은 자칫하면 놓치기 쉬운 포인트다.

## 정리

프로그램의 규모가 커지면 전체적인 구조를 파악하기 어려워진다. 또한 비슷한 처리를 몇 번이고 반복해서 쓰고 싶어지는 경우도 생긴다.  
함수는 이 문제를 해결하기 위해 탄생했다.  

의미 있는 이름을 붙여서, 그 코드가 무엇을 하고 있는지 파악하기 쉬워진다.  
그리고 그 함수를 다른 장소에서 호출하여 사용함으로 재사용도 가능해진다.  
함수를 사용함으로 '재귀 호출'이라는 코딩 기술이 탄생했다. 이것은 내포 구조로 된 데이터를 다루기에 적합한 기법이다.

### 이름

함수를 사용한 처리에 이름을 붙이는 행위는 '처리가 시작되는 메모리상의 위치'를 수치로 표현하는 대신,  
알기 쉬운 문자열로 표현하는 행위다.  
변수도 '값이 기록된 메모리 위치'를 수치가 아닌 문자열로 표현하기 위해 만들어졌다.
